MACRO (MYPACKAGEREPAIR)
  IF (NOT HAVE_STDINT_H)
    GET_PROPERTY(source_dir_set GLOBAL PROPERTY MYPACKAGE_SOURCE_DIR SET)
    IF (NOT ${source_dir_set})
      MESSAGE (WARNING "Cannot repair anything if any, property MYPACKAGE_SOURCE_DIR is not set")
    ELSE ()
      IF (NOT STDINT_H_SINGLETON)
        GET_PROPERTY(source_dir GLOBAL PROPERTY MYPACKAGE_SOURCE_DIR)
        MESSAGE(STATUS "Generating a minimal stdint.h")
        SET(MYPACKAGE_GENERATED_INCLUDE_DIR "__generated_include_dir__")
        FILE(MAKE_DIRECTORY ${MYPACKAGE_GENERATED_INCLUDE_DIR})
        CONFIGURE_FILE(${source_dir}/stdint.h.in ${MYPACKAGE_GENERATED_INCLUDE_DIR}/stdint.h)
        GET_FILENAME_COMPONENT(_MYPACKAGE_GENERATED_INCLUDE_DIR_ABSOLUTE ${MYPACKAGE_GENERATED_INCLUDE_DIR} ABSOLUTE)
        INCLUDE_DIRECTORIES(${_MYPACKAGE_GENERATED_INCLUDE_DIR_ABSOLUTE})
      ENDIF ()
      SET (STDINT_H_SINGLETON TRUE CACHE BOOL "C stdint.h repair singleton")
      MARK_AS_ADVANCED (STDINT_H_SINGLETON)
    ENDIF ()
  ENDIF ()
ENDMACRO()
